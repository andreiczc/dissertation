<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Sensor Management Interface</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>
  </head>
  <body>
    <div class="card" style="margin: 16px">
      <div style="margin: 16px">
        <h1 class="card-title">Sensor Management Interface</h1>

        <nav>
          <div class="nav nav-tabs" id="nav-tab" role="tablist">
            <button
              class="nav-link active"
              id="nav-temp-tab"
              data-bs-toggle="tab"
              data-bs-target="#nav-temp"
              type="button"
              role="tab"
              aria-controls="nav-temp"
              aria-selected="true"
            >
              Temperature
            </button>
            <button
              class="nav-link"
              id="nav-humidity-tab"
              data-bs-toggle="tab"
              data-bs-target="#nav-humidity"
              type="button"
              role="tab"
              aria-controls="nav-humidity"
              aria-selected="false"
            >
              Humidity
            </button>
            <button
              class="nav-link"
              id="nav-gases-tab"
              data-bs-toggle="tab"
              data-bs-target="#nav-gases"
              type="button"
              role="tab"
              aria-controls="nav-gases"
              aria-selected="false"
            >
              Gases
            </button>
            <button
              class="nav-link"
              id="nav-vibration-tab"
              data-bs-toggle="tab"
              data-bs-target="#nav-vibration"
              type="button"
              role="tab"
              aria-controls="nav-vibration"
              aria-selected="false"
            >
              Vibration
            </button>
          </div>
        </nav>
        <div class="tab-content" id="nav-tabContent">
          <div
            class="tab-pane fade show active"
            id="nav-temp"
            role="tabpanel"
            aria-labelledby="nav-temp-tab"
          >
            <div class="form-check form-switch">
              <input
                class="form-check-input"
                type="checkbox"
                id="tempEnable"
                checked
              />
              <label class="form-check-label" for="tempEnable">Enabled</label>
            </div>
            <div id="tempEnabledDiv">
              <div class="form-check form-switch">
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="tempBlockchain"
                />
                <label class="form-check-label" for="tempBlockchain"
                  >Blockchain integration</label
                >
              </div>
              <form
                id="tempBlockchainData"
                style="display: none; margin-left: 16px"
              >
                <div class="mb-3">
                  <label for="tempBlockchainContract" class="form-label"
                    >Contract address</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="tempBlockchainContract"
                  />
                </div>
                <div class="mb-3">
                  <label for="tempBlockchainParams" class="form-label"
                    >Contract data</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="tempBlockchainParams"
                  />
                </div>
              </form>
              <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" id="tempMl" />
                <label class="form-check-label" for="tempMl"
                  >ML integration</label
                >
              </div>
              <form id="tempMlData" style="display: none; margin-left: 16px">
                <div class="mb-3">
                  <label for="tempMlModel" class="form-label"
                    >ML model in Base64</label
                  >
                  <input type="text" class="form-control" id="tempMlModel" />
                </div>
              </form>
            </div>
            <input
              id="tempSubmit"
              style="margin-top: 32px"
              type="submit"
              class="btn btn-secondary"
            />
            <div
              id="tempSuccess"
              style="margin: 16px; display: none"
              class="alert alert-success"
              role="alert"
            >
              Temp sensor settings saved successfully!
            </div>
          </div>
          <div
            class="tab-pane fade"
            id="nav-humidity"
            role="tabpanel"
            aria-labelledby="nav-humidity-tab"
          >
            <div class="form-check form-switch">
              <input
                class="form-check-input"
                type="checkbox"
                id="humidityEnable"
                checked
              />
              <label class="form-check-label" for="humidityEnable"
                >Enabled</label
              >
            </div>
            <div id="humidityEnabledDiv">
              <div class="form-check form-switch">
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="humidityBlockchain"
                />
                <label class="form-check-label" for="humidityBlockchain"
                  >Blockchain integration</label
                >
              </div>
              <form
                id="humidityBlockchainData"
                style="display: none; margin-left: 16px"
              >
                <div class="mb-3">
                  <label for="humidityBlockchainContract" class="form-label"
                    >Contract address</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="humidityBlockchainContract"
                  />
                </div>
                <div class="mb-3">
                  <label for="humidityBlockchainParams" class="form-label"
                    >Contract data</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="humidityBlockchainParams"
                  />
                </div>
              </form>
              <div class="form-check form-switch">
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="humidityMl"
                />
                <label class="form-check-label" for="humidityMl"
                  >ML integration</label
                >
              </div>
              <form
                id="humidityMlData"
                style="display: none; margin-left: 16px"
              >
                <div class="mb-3">
                  <label for="humidityMlModel" class="form-label"
                    >ML model in Base64</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="humidityMlModel"
                  />
                </div>
              </form>
              <input
                id="humiditySubmit"
                style="margin-top: 32px"
                type="submit"
                class="btn btn-secondary"
              />
              <div
                id="humiditySuccess"
                style="margin: 16px; display: none"
                class="alert alert-success"
                role="alert"
              >
                Humidity sensor settings saved successfully!
              </div>
            </div>
          </div>
          <div
            class="tab-pane fade"
            id="nav-gases"
            role="tabpanel"
            aria-labelledby="nav-gases-tab"
          >
            <div class="form-check form-switch">
              <input
                class="form-check-input"
                type="checkbox"
                id="humidityEnable"
                checked
              />
              <label class="form-check-label" for="humidityEnable"
                >Enabled</label
              >
            </div>
            <div id="humidityEnabledDiv">
              <div class="form-check form-switch">
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="humidityBlockchain"
                />
                <label class="form-check-label" for="humidityBlockchain"
                  >Blockchain integration</label
                >
              </div>
              <form
                id="humidityBlockchainData"
                style="display: none; margin-left: 16px"
              >
                <div class="mb-3">
                  <label for="humidityBlockchainContract" class="form-label"
                    >Contract address</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="humidityBlockchainContract"
                  />
                </div>
                <div class="mb-3">
                  <label for="humidityBlockchainParams" class="form-label"
                    >Contract data</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="humidityBlockchainParams"
                  />
                </div>
              </form>
              <div class="form-check form-switch">
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="humidityMl"
                />
                <label class="form-check-label" for="humidityMl"
                  >ML integration</label
                >
              </div>
              <form
                id="humidityMlData"
                style="display: none; margin-left: 16px"
              >
                <div class="mb-3">
                  <label for="humidityMlModel" class="form-label"
                    >ML model in Base64</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="humidityMlModel"
                  />
                </div>
              </form>
              <input
                id="humiditySubmit"
                style="margin-top: 32px"
                type="submit"
                class="btn btn-secondary"
              />
              <div
                id="gasSuccess"
                style="margin: 16px; display: none"
                class="alert alert-success"
                role="alert"
              >
                Gas sensor settings saved successfully!
              </div>
            </div>
          </div>
          <div
            class="tab-pane fade"
            id="nav-vibration"
            role="tabpanel"
            aria-labelledby="nav-vibration-tab"
          >
            <div class="form-check form-switch">
              <input
                class="form-check-input"
                type="checkbox"
                id="humidityEnable"
                checked
              />
              <label class="form-check-label" for="humidityEnable"
                >Enabled</label
              >
            </div>
            <div id="humidityEnabledDiv">
              <div class="form-check form-switch">
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="humidityBlockchain"
                />
                <label class="form-check-label" for="humidityBlockchain"
                  >Blockchain integration</label
                >
              </div>
              <form
                id="humidityBlockchainData"
                style="display: none; margin-left: 16px"
              >
                <div class="mb-3">
                  <label for="humidityBlockchainContract" class="form-label"
                    >Contract address</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="humidityBlockchainContract"
                  />
                </div>
                <div class="mb-3">
                  <label for="humidityBlockchainParams" class="form-label"
                    >Contract data</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="humidityBlockchainParams"
                  />
                </div>
              </form>
              <div class="form-check form-switch">
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="humidityMl"
                />
                <label class="form-check-label" for="humidityMl"
                  >ML integration</label
                >
              </div>
              <form
                id="humidityMlData"
                style="display: none; margin-left: 16px"
              >
                <div class="mb-3">
                  <label for="humidityMlModel" class="form-label"
                    >ML model in Base64</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="humidityMlModel"
                  />
                </div>
              </form>
              <input
                id="humiditySubmit"
                style="margin-top: 32px"
                type="submit"
                class="btn btn-secondary"
              />
              <div
                id="vibrationSuccess"
                style="margin: 16px; display: none"
                class="alert alert-success"
                role="alert"
              >
                Vibration sensor settings saved successfully!
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      function setup(switchId, additionalDataId) {
        const switchElement = document.getElementById(switchId);
        const additionalDataElement = document.getElementById(additionalDataId);

        switchElement.addEventListener("click", (ev) => {
          const showAdditionalData = ev.target.checked;
          additionalDataElement.style.display = showAdditionalData
            ? "block"
            : "none";
        });
      }

      function prepareDiv(prefix) {
        setup(`${prefix}Blockchain`, `${prefix}BlockchainData`);
        setup(`${prefix}Ml`, `${prefix}MlData`);
        setup(`${prefix}Enable`, `${prefix}EnabledDiv`);

        const button = document.getElementById(`${prefix}Submit`);
        button.addEventListener("click", (ev) => {
          const confirmationBox = document.getElementById(`${prefix}Success`);
          confirmationBox.style.display = "block";

          const blockchain = document.getElementById(`${prefix}Blockchain`)
            .checked
            ? `${
                document.getElementById(`${prefix}BlockchainContract`).value
              } ${document.getElementById(`${prefix}BlockchainParams`).value}`
            : "";

          const ml = document.getElementById(`${prefix}Ml`).checked
            ? document.getElementById(`${prefix}MlModel`).value
            : "";

          const payload = {
            enabled: document.getElementById(`${prefix}Enable`).checked,
            blockchain: blockchain,
            ml: ml,
          };

          const url = `http://localhost:8080/${prefix}`;
          const data = JSON.stringify(payload);
          console.log(`Sending POST to ${url}. Payload: ${data}`);

          fetch(url, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: data,
          });

          setTimeout(() => (confirmationBox.style.display = "none"), 15000);
        });
      }

      prepareDiv("temp");
      prepareDiv("humidity");
      prepareDiv("gas");
      prepareDiv("vibration");
    </script>
  </body>
</html>
